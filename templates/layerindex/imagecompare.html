{% extends "base.html" %}
{% load i18n %}
{% load static %}

{% comment %}

  layerindex-web - image comparison page template

  Copyright (C) 2018 Intel Corporation
  Licensed under the MIT license, see COPYING.MIT for details

{% endcomment %}

<!--
{% block title_append %} - image comparison{% endblock %}
-->

{% block content %}
{% autoescape on %}

<h2>Compare image</h2>

<p>This tool allows you to compare the contents of an image (based on a manifest) with packages in another distribution.</p>

<p>To get started, either resume an existing image comparison or create a new one.</p>

{% if comparisons %}
    <h3>Select an existing comparison</h3>
    <ul>
    {% for comparison in comparisons %}
        <li><a href="{% url 'image_comparison_search' comparison.id %}">{{ comparison.name }}</a></li>
    {% endfor %}
    </ul>
{% endif %}

<h3>Create a new comparison</h3>

<ol>
<li>Download the <b><a href="{% static "files/oe-image-manifest" %}">oe-image-manifest script</a></b></li>
<li>Copy/move it to the <code>scripts</code> subdirectory of your build system</li>
<li>Make it executable:<br><code>chmod +x scripts/oe-image-manifest</code></li>
<li>Initialise the build environment (if you have not already):<br><code>. ./oe-init-build-env</code></li>
<li>Run the script:<br><code>oe-image-manifest export-info path/to/tmp/deploy/images/<i>machinename</i>/<i>imagename</i>.manifest</code></li>
<li>Submit the resulting .tar.gz file below:
</ol>

<form class="form-inline" enctype="multipart/form-data" method="POST">
    {% csrf_token %}
    {% for hidden in form.hidden_fields %}
        {{ hidden }}
    {% endfor %}
    {% for field in form.visible_fields %}
        {% if field.errors %}
        <div class="control-group alert alert-danger">
        {{ field.errors }}
        {% endif %}
        <div class="control-group">
            {{ field.label_tag }}
            {{ field }}
            <span class="help-inline custom-help">
                {{ field.help_text }}
            </span>
        {% if field.errors %}
        </div>
        {% endif %}
        </div>
    {% endfor %}
    <div class="control-group">
        <div class="controls">
            <button type="submit" class="btn btn-default">Create</button>
        </div>
    </div>
</form>

{% endautoescape %}

{% endblock %}
